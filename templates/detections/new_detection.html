{% extends "layouts/base.html" %}

{% block content %}

<form action="{% url 'api:run' %}" method="post" enctype="multipart/form-data" id="detect-form">
    Select image to upload:
    <input type="file" name="original_image" id="original_image">
    <input type="submit" value="Upload Image" name="submit">
</form>

{% endblock content %}

{% block script %}

<script>

var csrftoken = '{{ csrf_token }}';

// var csrftoken = getCookie('csrftoken');
        
        $( "#detect-form" ).submit(function( event ) {
            event.preventDefault();

            var form = $(this);
            var data = new FormData(form[0]);
            var url = form.attr( "action" );

            $.ajax({
                url: url,
                type: 'post',
                data: data,
                cache: false,
                contentType: false,
                processData: false,
                headers: {
                    'X-CSRFToken': csrftoken
                },
                success: function (data, status) {
                    console.info(data);
                    console.info(status);
                }
            });
        
        });
        
        </script>
  
{% endblock script %}